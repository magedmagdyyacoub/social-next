{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 52, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Barakat/Desktop/social-next/lib/prisma.js"],"sourcesContent":["import { PrismaClient } from \"@prisma/client\";\r\n\r\nconst globalForPrisma = globalThis;\r\n\r\nexport const prisma =\r\n  globalForPrisma.prisma ||\r\n  new PrismaClient();\r\n\r\nif (process.env.NODE_ENV !== \"production\") globalForPrisma.prisma = prisma;\r\n\r\nexport default prisma;\r\n"],"names":[],"mappings":";;;;;;AAAA;;AAEA,MAAM,kBAAkB;AAEjB,MAAM,SACX,gBAAgB,MAAM,IACtB,IAAI,6IAAY;AAElB,wCAA2C,gBAAgB,MAAM,GAAG;uCAErD"}},
    {"offset": {"line": 74, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Barakat/Desktop/social-next/app/api/user/update/route.js"],"sourcesContent":["import { NextResponse } from \"next/server\";\r\nimport prisma from \"../../../../lib/prisma\";\r\nimport { writeFile } from \"fs/promises\";\r\nimport { cookies } from \"next/headers\";\r\n\r\nexport async function POST(req) {\r\n  try {\r\n    const form = await req.formData();\r\n    const name = form.get(\"name\");\r\n    const bio = form.get(\"bio\");\r\n    const image = form.get(\"image\");\r\n\r\n    let imageUrl = null;\r\n\r\n    if (image && typeof image === \"object\") {\r\n      const bytes = await image.arrayBuffer();\r\n      const buffer = Buffer.from(bytes);\r\n      const fileName = `profile_${Date.now()}_${image.name}`;\r\n      await writeFile(`public/uploads/${fileName}`, buffer);\r\n      imageUrl = `/uploads/${fileName}`;\r\n    }\r\n\r\n    // ✅ الطريقة الصحيحة في Next.js 15\r\n    const cookieStore = await cookies();\r\n    const userId = cookieStore.get(\"userId\")?.value;\r\n\r\n    if (!userId) {\r\n      return NextResponse.json(\r\n        { error: \"Not authenticated\" },\r\n        { status: 401 }\r\n      );\r\n    }\r\n\r\n    const updatedUser = await prisma.user.update({\r\n      where: { id: userId },\r\n      data: {\r\n        name,\r\n        bio,\r\n        ...(imageUrl && { image: imageUrl }),\r\n      },\r\n    });\r\n\r\n    return NextResponse.json({ user: updatedUser });\r\n  } catch (err) {\r\n    console.error(\"UPDATE ERROR:\", err);\r\n    return NextResponse.json({ error: \"Update failed\" }, { status: 500 });\r\n  }\r\n}\r\n"],"names":[],"mappings":";;;;AAAA;AACA;AACA;AACA;;;;;AAEO,eAAe,KAAK,GAAG;IAC5B,IAAI;QACF,MAAM,OAAO,MAAM,IAAI,QAAQ;QAC/B,MAAM,OAAO,KAAK,GAAG,CAAC;QACtB,MAAM,MAAM,KAAK,GAAG,CAAC;QACrB,MAAM,QAAQ,KAAK,GAAG,CAAC;QAEvB,IAAI,WAAW;QAEf,IAAI,SAAS,OAAO,UAAU,UAAU;YACtC,MAAM,QAAQ,MAAM,MAAM,WAAW;YACrC,MAAM,SAAS,OAAO,IAAI,CAAC;YAC3B,MAAM,WAAW,CAAC,QAAQ,EAAE,KAAK,GAAG,GAAG,CAAC,EAAE,MAAM,IAAI,EAAE;YACtD,MAAM,IAAA,kIAAS,EAAC,CAAC,eAAe,EAAE,UAAU,EAAE;YAC9C,WAAW,CAAC,SAAS,EAAE,UAAU;QACnC;QAEA,kCAAkC;QAClC,MAAM,cAAc,MAAM,IAAA,4IAAO;QACjC,MAAM,SAAS,YAAY,GAAG,CAAC,WAAW;QAE1C,IAAI,CAAC,QAAQ;YACX,OAAO,gJAAY,CAAC,IAAI,CACtB;gBAAE,OAAO;YAAoB,GAC7B;gBAAE,QAAQ;YAAI;QAElB;QAEA,MAAM,cAAc,MAAM,0HAAM,CAAC,IAAI,CAAC,MAAM,CAAC;YAC3C,OAAO;gBAAE,IAAI;YAAO;YACpB,MAAM;gBACJ;gBACA;gBACA,GAAI,YAAY;oBAAE,OAAO;gBAAS,CAAC;YACrC;QACF;QAEA,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,MAAM;QAAY;IAC/C,EAAE,OAAO,KAAK;QACZ,QAAQ,KAAK,CAAC,iBAAiB;QAC/B,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAAgB,GAAG;YAAE,QAAQ;QAAI;IACrE;AACF"}}]
}